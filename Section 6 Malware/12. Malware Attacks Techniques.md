
### **Malware Exploitation Techniques Study Notes**

#### **1. Evolution of Malware Techniques**

*   **Historical (File-Based):** Malware relied on infecting executable files or documents (macros) stored on the disk. Activation occurred when the user opened or ran the infected file.
*   **Modern (Fileless):** Malware executes directly in **system memory (RAM)** without relying on the local file system, leaving minimal traces. This technique **bypasses traditional, signature-based antivirus** solutions.

#### **2. Modern Malware Deployment: The Two-Stage Model**

Modern attacks use a phased approach to infiltrate and persist within a network.

| Stage | Component | Description |
| :--- | :--- | :--- |
| **Stage 1: Initial Compromise** | **Dropper / Downloader** | A lightweight, initial piece of malware delivered via a malicious link or file. Its job is to establish a foothold. |
| **Stage 2: Establishment & Expansion** | **Remote Access Trojan (RAT)** | The dropper/downloader retrieves and installs a RAT, giving the attacker **command and control (C2)** over the victim's system. The attacker then moves laterally to compromise more systems, targeting high-value assets like servers. |
| **Stage 3: Action on Objectives** | **Primary Payload** | The attacker executes their final goal, such as **data exfiltration, ransomware encryption**, or other destructive actions. |
| **Stage 4: Persistence** | **Concealment** | The attacker covers their tracks by **erasing logs, hiding evidence**, and using other anti-forensic techniques to maintain long-term access. |

#### **3. Key Terminology**

*   **Dropper:** Malware that *installs* other malware components from within its payload onto the infected host.
*   **Downloader:** Malware that *retrieves* additional malicious tools from the internet *after* the initial infection.
*   **Shellcode:** A small, lightweight piece of code used as the payload to exploit a vulnerability in the target software.
*   **Fileless Malware:** Malware that resides solely in memory, leaving little to no evidence on the hard drive.

#### **4. Common Delivery & Evasion Techniques**

*   **Code Injection:** Running malicious code within the context of a legitimate process.
*   **DLL Injection / Sideloading:** Forcing a legitimate program to load a malicious Dynamic-Link Library (DLL).
*   **Process Hollowing:** Replacing the code in a legitimate process's memory with malicious code.
*   **Masquerading:** Disguising malicious files or processes to look like legitimate ones.
*   **Obfuscation, Encryption, Compression:** Techniques used to hide malicious code from analysis and detection.

#### **5. Advanced Strategy: Living Off the Land (LotL)**

*   **Concept:** Attackers use **pre-installed, legitimate system tools** to conduct malicious activities, making detection very difficult.
*   **Common Tool Example:** **PowerShell** on Windows systems. Attackers use its powerful scripting capabilities for reconnaissance, lateral movement, and payload execution.
*   **Advantage for Attackers:** These tools are trusted, whitelisted, and generate logs that look normal, allowing attacks to **blend in with legitimate administrative activity**.

---
### **Summary & Key Takeaways**

*   The shift from **file-based** to **fileless** malware is a major evolution that defeats traditional antivirus.
*   Attacks follow a **methodical, multi-stage process** (Dropper → RAT → Action on Objectives → Concealment).
*   **Living Off the Land (LotL)** is a sophisticated technique that abuses trusted system tools, making it a significant challenge for defenders.
*   **Defense Strategy:** Security must focus on **behavioral analysis** (not just signatures), **strict application control**, **robust logging and monitoring** of system tools like PowerShell, and **network segmentation** to limit lateral movement.