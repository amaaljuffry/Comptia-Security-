
### **Rootkits Study Notes**

#### **1. Core Concept & Definition**

*   **Definition:** A rootkit is a type of malicious software designed to **gain administrative-level control** over a computer system **without being detected**.
*   **Objective:** To obtain the highest level of permissions:
    *   **Windows:** `Administrator` account.
    *   **Unix/Linux/macOS:** `root` account.
*   **Key Characteristic:** Its primary goal is not just to gain access, but to **maintain persistent, undetectable access**.

#### **2. How Rootkits Work: The "Rings" of Privilege**

Modern operating systems use a hierarchy of privilege levels, visualized as concentric rings.

| Ring Level | Name | Purpose & Access |
| :--- | :--- | :--- |
| **Ring 0** | **Kernel Mode** | The **innermost, most privileged ring**. Controls access to hardware (CPU, memory, devices). The core of the OS operates here. |
| **Ring 1** | System Services | A privileged level, closer to the kernel. Administrator/root users operate from here. |
| **Ring 3** | **User Mode** | The **outermost, least privileged ring**. Where standard user applications and programs run. |

*   **Rootkit Strategy:** A rootkit starts at Ring 3 (user level) and works its way **down to Ring 0 (kernel mode)**. The closer it gets to Ring 0, the more control it has and the better it can **hide itself** from the OS and security software.

#### **3. Stealth Techniques: Hiding from the OS**

*   **DLL Injection:** A technique used to run malicious code within the address space of a legitimate process by forcing it to load a malicious Dynamic-Link Library (DLL).
    *   **DLL (Dynamic-Link Library):** A library of code and data that multiple programs can use simultaneously. A core part of Windows.
*   **Shim:** A piece of code placed between two components (e.g., the OS and a DLL) to **intercept and redirect communications**. This allows the rootkit to embed itself deeply into system operations.

#### **4. The Danger & Impact**

*   **Total Control:** With kernel-level access, an attacker can:
    *   Install/delete any software.
    *   Create/remove user accounts.
    *   Open/close network ports.
    *   Intercept keystrokes.
    *   Steal data.
*   **Extreme Stealth:** Because rootkits operate at or near the kernel level, they can **hide their processes, files, and network connections** from the operating system and most traditional antivirus software.

#### **5. Detection and Removal**

*   **Traditional antivirus often fails** because it runs *inside* the compromised OS, which the rootkit is actively hiding from.
*   **The Best Method:** Conduct an **external scan**.
    1.  Power down the infected computer.
    2.  Boot from a known-clean, external device (e.g., a **Live Linux USB** with antivirus tools).
    3.  Scan the internal hard drive from this clean environment. Since the rootkit is not active in memory, it cannot hide itself, making detection and removal possible.

---
### **Summary & Key Takeaways**

*   **Goal:** Gain **undetectable, administrative (root)** access.
*   **Method:** Moves from **Ring 3 (User Mode)** to **Ring 0 (Kernel Mode)** to achieve maximum privilege and stealth.
*   **Technique:** Often uses **DLL Injection** and **Shims** to embed itself into the core operating system processes.
*   **Challenge:** **Extremely difficult to detect** with standard, in-OS security tools because the rootkit controls what the OS sees.
*   **Solution:** Detection requires **external analysis** by booting from a clean, trusted source to scan the infected drive.