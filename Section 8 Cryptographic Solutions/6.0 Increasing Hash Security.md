

### **Increasing Hash Security - Study Notes**

#### **1. Common Hashing Attacks**

##### *A. Pass-the-Hash Attack*
*   **Concept:** An attack where a threat actor uses the *hash* of a user's password (instead of the plaintext password itself) to authenticate to a remote server or service.
*   **How it Works:**
    1.  An attacker steals or "harvests" password hashes from a compromised system.
    2.  They then present this hash directly to a service for authentication.
    3.  If successful, they can impersonate the user without ever knowing the actual password.
*   **Why it's Dangerous:**
    *   Hashes are functionally equivalent to passwords for authentication in many systems.
    *   Attackers don't need to spend time cracking the hash (via brute force) to discover the plaintext password.
    *   Tools like **Mimikatz** can automate hash harvesting and exploitation.
*   **Defense Strategies:**
    *   Use **multifactor authentication (MFA)**.
    *   Enforce the **principle of least privilege** for all user accounts.
    *   Ensure all systems (workstations and servers) are **patched and updated**.
    *   Configure Windows domains with proper trust settings.
    *   Allow only trusted, secured operating systems to connect to critical servers.

##### **B. Birthday Attack**
*   **Concept:** An attack that exploits the mathematical probability of finding two different inputs that produce the **same hash output**, known as a **collision**.
*   **The Birthday Paradox:** In a room of only 23 people, there's a 50% chance two share a birthday. This illustrates how collisions are more common than intuition suggests.
*   **How it Works:** An attacker searches for or creates two different messages that generate an identical hash digest. They can then substitute a malicious file for a legitimate one, or bypass authentication if a password collision is found.
*   **Defense Strategy:**
    *   Use hashing algorithms with **longer output digests** (e.g., **SHA-256** or **SHA-3** instead of MD5). This dramatically increases the number of possible hashes, making collisions computationally infeasible to find.

---

#### **2. Techniques to Increase Hash Security**

##### **A. Key Stretching**
*   **Purpose:** To mitigate the weakness of a short or weak key (or password) by increasing the time and computational resources needed to crack it.
*   **How it Works:** A weak key is run through a special algorithm that performs many rounds of hashing or other operations, producing a longer, more secure derived key.
*   **Common Implementations:** Used in **WPA/WPA2 (Wi-Fi)**, **PGP (Pretty Good Privacy)**, and other security systems.

##### **B. Salting**
*   **Purpose:** To defeat pre-computation attacks and ensure that identical passwords result in unique hashes.
*   **What is a Salt?** A **large, random, unique string of data** added to a password *before* it is hashed.
*   **How it Works:** The system generates a unique salt for each user/password. The salt is stored alongside the hash (usually in plaintext).
*   **Benefits & Attacks it Thwarts:**
    *   **Different Hashes for Same Passwords:** Two users with the password "hello" will have completely different hashes due to different salts.
    *   **Defeats Rainbow Tables:** Pre-computed tables of hash values for common passwords become useless because the salt is not accounted for in the table.
    *   **Slows Down Dictionary/Brute-Force Attacks:** The attacker must compute the hash for *each guess + the specific salt* for each user, making the process vastly more time-consuming.

##### **C. Nonce (Number Used Once)**
*   **Purpose:** To prevent **replay attacks** by ensuring that each authentication session or transaction is unique.
*   **How it Works:** A unique, often random, number (the nonce) is used only once in a cryptographic communication. It is added to the password or data before hashing.
*   **Benefit:** Even if an attacker captures the hashed authentication data, they cannot reuse it because the nonce will be different in the next session, changing the resulting hash.

##### **D. Limiting Failed Login Attempts (Account Lockout)**
*   **Purpose:** To deter and slow down online password cracking attacks (brute force and dictionary attacks).
*   **How it Works:** The system is configured to **lock an account** after a small number of failed login attempts (e.g., 3 or 5).
*   **Consideration:** While this greatly increases security, it can also lock out legitimate users who forget their passwords. This is a trade-off between security and usability.

---

### **Summary & Key Takeaways**

| Concept | What it is | Why it's Used |
| :--- | :--- | :--- |
| **Pass-the-Hash** | Attack using a stolen hash to authenticate. | Defend with **MFA, patching, and least privilege**. |
| **Birthday Attack** | Attack that exploits hash **collisions**. | Defend by using **longer hashes (SHA-256+)**. |
| **Key Stretching** | Technique to strengthen weak keys using many computational rounds. | Makes password cracking **slower and more expensive**. |
| **Salting** | Adding **random data** to a password before hashing. | **Defeats rainbow tables** and ensures unique hashes. |
| **Nonce** | A **"number used once"** in authentication. | Prevents **replay attacks**. |
| **Login Attempt Limits** | Locking an account after too many failed logins. | Slows down **online brute-force/dictionary attacks**. |

**Core Principle:** A layered defense combining these techniques is essential to protect password hashes and authentication systems from modern threats.